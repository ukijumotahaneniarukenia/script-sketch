create or replace type liz_typ is object (id number,qty number);


create or replace type liz_multi is table of liz_typ;


WITH src_a AS( SELECT LEVEL AS rn,LEVEL * 5 AS qty FROM dual WHERE MOD(LEVEL,2) = 0 OR MOD(LEVEL,3) = 0 CONNECT BY LEVEL <= 10 ),src_b AS ( SELECT LEVEL AS rn,LEVEL * 5 AS qty FROM dual WHERE MOD(LEVEL,3) = 0 OR MOD(LEVEL,5) = 0 CONNECT BY LEVEL <= 10 ) ,sub AS ( SELECT A ,b ,A MULTISET UNION b AS a_union_b ,b MULTISET UNION A AS b_union_a ,A MULTISET UNION ALL b AS a_union_all_b ,b MULTISET UNION ALL A AS b_union_all_a ,A MULTISET UNION DISTINCT b AS a_union_distinct_b ,b MULTISET UNION DISTINCT A AS b_union_distinct_a ,A MULTISET INTERSECT b AS a_intersect_b ,b MULTISET INTERSECT A AS b_intersect_a ,A MULTISET INTERSECT DISTINCT b AS a_intersect_distinct_b ,b MULTISET INTERSECT DISTINCT A AS b_intersect_distinct_a ,A MULTISET EXCEPT b AS a_except_b ,b MULTISET EXCEPT A AS b_except_a ,A MULTISET EXCEPT DISTINCT b AS a_except_distinct_b ,b MULTISET EXCEPT DISTINCT A AS b_except_distinct_a FROM (SELECT CAST(COLLECT(liz_typ(rn,qty)) AS liz_multi) AS A FROM src_a) CROSS JOIN (SELECT CAST(COLLECT(liz_typ(rn,qty)) AS liz_multi) AS b FROM src_b) ) SELECT * FROM sub UNPIVOT(cols FOR sts IN (A, b, a_union_b, b_union_a, a_union_all_b, b_union_all_a, a_union_distinct_b, b_union_distinct_a, a_intersect_b, b_intersect_a, a_intersect_distinct_b, b_intersect_distinct_a, a_except_b, b_except_a, a_except_distinct_b, b_except_distinct_a)) ;

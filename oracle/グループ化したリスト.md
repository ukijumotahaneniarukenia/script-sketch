
```

create or replace type mapliz as object (grp number,remain_liz liz,fetch_liz liz);
/

drop type grpliz;

create or replace type grpliz is table of mapliz;
/

```

```

select * from table(GRPLIZ(MAPLIZ(1, LIZ('a','b','c', 'd'), LIZ(''))));


```

```

USER01@ORCLPDB01> column grp for 99
USER01@ORCLPDB01> column remain_liz for a50
USER01@ORCLPDB01> column fetch_liz for a50
USER01@ORCLPDB01> select * from table(GRPLIZ(MAPLIZ(1, LIZ('a','b','c', 'd'), LIZ(''))));

GRP REMAIN_LIZ                                         FETCH_LIZ
--- -------------------------------------------------- --------------------------------------------------
  1 LIZ('a', 'b', 'c', 'd')                            LIZ(NULL)

1行が選択されました。

経過: 00:00:00.01

```


書く処理結果をグルーピングして持ち回る
```
USER01@ORCLPDB01> column grp for 99
USER01@ORCLPDB01> column remain for a30
USER01@ORCLPDB01> column fetch_liz for a40
USER01@ORCLPDB01> column grpliz for a50
with sub as(
  select grp,remain_liz,fetch_liz,cnt(remain_liz) as remain_cnt from table(GRPLIZ(MAPLIZ(1, LIZ('a','b','c', 'd'), LIZ(''))))
),rec (grp,ele,remain,fetch_liz,remain_cnt)as(
  select 1,liz(shift(remain_liz)) as ele,del_ele(shift(remain_liz),remain_liz) as remain,liz(shift(remain_liz)) as fetch_liz,remain_cnt from sub
  union all
  select grp+1,liz(shift(remain)) as ele,del_ele(shift(remain),remain),fetch_liz multiset union all liz(shift(remain)),remain_cnt from rec
  where grp+1 <= remain_cnt
  8  )select grp,remain,fetch_liz,GRPLIZ(MAPLIZ(grp, remain, fetch_liz)) as GRPLIZ from rec;

GRP REMAIN                         FETCH_LIZ                                GRPLIZ(GRP, REMAIN_LIZ, FETCH_LIZ)
--- ------------------------------ ---------------------------------------- --------------------------------------------------
  1 LIZ('b', 'c', 'd')             LIZ('a')                                 GRPLIZ(MAPLIZ(1, LIZ('b', 'c', 'd'), LIZ('a')))
  2 LIZ('c', 'd')                  LIZ('a', 'b')                            GRPLIZ(MAPLIZ(2, LIZ('c', 'd'), LIZ('a', 'b')))
  3 LIZ('d')                       LIZ('a', 'b', 'c')                       GRPLIZ(MAPLIZ(3, LIZ('d'), LIZ('a', 'b', 'c')))
  4 LIZ()                          LIZ('a', 'b', 'c', 'd')                  GRPLIZ(MAPLIZ(4, LIZ(), LIZ('a', 'b', 'c', 'd')))

4行が選択されました。

経過: 00:00:00.00


```

蓄積結果をグルーピングして持ちまわる

```


create or replace type mapliz as object (grp number,remain_liz liz,fetch_liz liz,cum_liz liz);
/

drop type grpliz;

create or replace type grpliz is table of mapliz;
/


```


```

USER01@ORCLPDB01> column grp for 99
USER01@ORCLPDB01> column remain_liz for a30
USER01@ORCLPDB01> column fetch_liz for a30
USER01@ORCLPDB01> column cum_liz for a30
USER01@ORCLPDB01> select grp,remain_liz,fetch_liz,cum_liz,cnt(remain_liz) as remain_cnt from table(GRPLIZ(MAPLIZ(1, LIZ('a','b','c', 'd'), LIZ(''), LIZ(''))));

GRP REMAIN_LIZ                     FETCH_LIZ                      CUM_LIZ                           REMAIN_CNT
--- ------------------------------ ------------------------------ ------------------------------ -------------
  1 LIZ('a', 'b', 'c', 'd')        LIZ(NULL)                      LIZ(NULL)                                  4

1行が選択されました。

経過: 00:00:00.00

```

```
create or replace type liz is table of varchar2(4000);
/
create or replace function cnt(rsv_args liz)
return number
as
rt number;
begin
    select count(*) into rt from table(rsv_args);
    return rt;
end;
/

create type mymap as object (key varchar2(4000), value number);
/
create type mymapliz is table of mymap;
/
create or replace type mymaplizz as object (id number,value mymapliz);
/
create or replace type mymaplizzz is table of mymaplizz;
/

create or replace function div(denominator number,start_rn number,end_rn number)
return mymaplizzz
as
rt mymaplizzz;
begin
    with sub as(
        select
            level as numerator
            ,denominator as denominator
            ,level/denominator as quotient
            ,remainder(level,denominator) as remainder
            ,mod(level,denominator) as modulo
            ,level - denominator*floor(level/denominator) as remain_floor
            ,level - denominator*trunc(level/denominator) as remain_trunc
            ,level - denominator*round(level/denominator) as remain_round
            ,level - denominator*ceil(level/denominator) as remain_ceil
            ,floor(level/denominator) as floor
            ,trunc(level/denominator) as trunc
            ,round(level/denominator) as round
            ,ceil(level/denominator) as ceil
        from dual
        where
            level >= start_rn
        connect by level <=end_rn
    ),subb as(
        select
            numerator
            ,cast(collect(mymap(cols,vals)) as mymapliz) as mymapliz_by_numerator
        from sub
        unpivot(vals for cols in (denominator, quotient, remainder, modulo, remain_floor, remain_trunc, remain_round, remain_ceil, floor, trunc, round, ceil))
        group by numerator
    )select cast(collect(mymaplizz(numerator,mymapliz_by_numerator)) as mymaplizzz) into rt from subb ;
    return rt;
end;
/

create or replace function split(rsv_args varchar2)
return liz
as
rt liz;
begin
    select
        cast(collect(substr(rsv_args,decode(level-1,0,0,instr(rsv_args,',',1,level-1))+1,decode(instr(rsv_args,',',1,level),0,4000,instr(rsv_args,',',1,level))-decode(level-1,0,0,instr(rsv_args,',',1,level-1))-1)) as liz)
    into rt
    from
        dual
    connect by
        level <=length(rsv_args) - length(replace(rsv_args,',',''))+1;
    return rt;
end;
/


:divisor=3
:divided_end=10

select id,value from table(div(3,3,11));

with sub as(
select id,value from table(div(3,3,11))
),subb as(
select s1.id,s2.key,s2.value
from sub s1,table(value) s2
)select * from subb pivot(min(value) for key in ('DENOMINATOR','QUOTIENT','REMAINDER','MODULO','REMAIN_FLOOR','REMAIN_TRUNC','REMAIN_ROUND','REMAIN_CEIL','FLOOR','TRUNC','ROUND','CEIL'))
order by id
;

```

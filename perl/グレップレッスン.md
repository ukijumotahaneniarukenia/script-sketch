# テストデータ

ファイル名を**array_dat.pm**で保存。拡張子は**pm**。
スコープを制限する**my**はつけない。つけるとインクルード先で見えない。

```bash
$echo 3 |\
 ./ランダムデータ作成.sh |\
 sh | xargs |\
 sed -e 's; ;\x27,\x27;g' -e 's;^;$array=[\x27;' -e 's;$;\x27]\;;' -e '1i#!/usr/local/bin/perl' -e '$a1;'
#!/usr/locali/perl
$array=['D','DI','DIS','S','SI','SID','M','Mj','Mj9','9','9j','9jM','r','r6','r6y','y','y6','y6r'];
1;
```

ファイル保存。

```bash
$echo 3 |\
 ./ランダムデータ作成.sh |\
 sh | xargs |\
 sed -e 's; ;\x27,\x27;g' -e 's;^;$array=[\x27;' -e 's;$;\x27]\;;' -e '1i#!/usr/local/bin/perl' -e '$a1;' > array_dat.pm
```

ファイルをそのままインクルードしようとすると以下のエラー。

```bash
$./グレップレッスン.pl
Can't locate array_dat.pm in @INC (you may need to install the array_dat module) (@INC contains: /home/sqlite/perl5/lib/perl5/5.30.0/x86_64-linux-thread /home/sqlite/perl5/lib/perl5/5.30.0 /home/sqlite/perl5/lib/perl5/x86_64-linux-thread /home/sqlite/perl5/lib/perl5 /home/sqlite/perl5/lib/perl5/x86_64-linux-thread-multi /usr/local//lib/perl5/site_perl/5.30.0/x86_64-linux /usr/local//lib/perl5/site_perl/5.30.0 /usr/local/lib/perl5/5.30.0/x86_64-linux /usr/local/lib/perl5/5.30.0) at ./グレップレッスン.pl line 3.
```

パス確認。


```bash
$perl -e 'print join("\n",@INC),"\n"'
/home/sqlite/perl5/lib/perl5/5.30.0/x86_64-linux-thread
/home/sqlite/perl5/lib/perl5/5.30.0
/home/sqlite/perl5/lib/perl5/x86_64-linux-thread
/home/sqlite/perl5/lib/perl5
/home/sqlite/perl5/lib/perl5/x86_64-linux-thread-multi
/usr/local//lib/perl5/site_perl/5.30.0/x86_64-linux
/usr/local//lib/perl5/site_perl/5.30.0
/usr/local/lib/perl5/5.30.0/x86_64-linux
/usr/local/lib/perl5/5.30.0
```
パスの通ったところに**array_dat.pm**を移動。

```bash
$ls array_dat.pm
array_dat.pm
$mv array_dat.pm /home/sqlite/perl5/lib/perl5/x86_64-linux-thread/array_dat.pm
$ls array_dat.pm
ls: cannot access array_dat.pm: No such file or directory
```

移動されたことを確認。

```bash
$find {/home/sqlite/perl5/lib/,/usr/local//lib/perl5/} -name "array_dat.pm"
/home/sqlite/perl5/lib/perl5/x86_64-linux-thread/array_dat.pm
```

# スクリプト

**grep**に引っ掛ける前と後で区別がつくように**-,=**で線引き。
移動した**array_dat.pm**を**require**でインクルード。
コマンドライン引数で与えた正規表現でgrep検索し、ヒットした文言を出力。

型確認が**[]**でできることを最近知った。

```perl
#!/usr/local/bin/perl

require "array_dat.pm";

sub test_grep{
  my $search_cond=shift @_;
  print $search_cond,"\n";
  print "-"x80,"\n";
  my $inc_array=$array;
  print @{$inc_array},"\n";
  print [@{$inc_array}],"\n";
  print join(",",@{$inc_array}),"\n";
  print "="x80,"\n";
  my @match=grep{$_ =~ /$search_cond/} @{$inc_array};
  print @match,"\n";
  print [@match],"\n";
  print join(",",@match),"\n";
}

sub main{
  test_grep(@ARGV);
}

main(@ARGV);
```

# 引数変えてマッチング確かめていく

[こんどこそわかる(肯|否)定(先|後)読み](https://qiita.com/tohta/items/2ba7ecde5636b38ef1f6)

**引数なし**は全部にマッチング

```bash
$./グレップレッスン.pl

--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0xcf93c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0xd1f8f8)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
```

**6を含むもの**にマッチング

```bash
$./グレップレッスン.pl 6
6
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0xafb3c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
r6r6yy6y6r
ARRAY(0xb14768)
r6,r6y,y6,y6r
```

**9を含むもの**にマッチング

```bash
$./グレップレッスン.pl 9
9
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x188d3c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
Mj999j9jM
ARRAY(0x18a6758)
Mj9,9,9j,9jM

```

**数字**にマッチング

```bash

$./グレップレッスン.pl \\d
\d
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x24a83c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
Mj999j9jMr6r6yy6y6r
ARRAY(0x24ce7b8)
Mj9,9,9j,9jM,r6,r6y,y6,y6r

```

**Dを含むもの**にマッチング

```bash

$./グレップレッスン.pl D
D
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x20a43c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
DDIDISSID
ARRAY(0x20bd768)
D,DI,DIS,SID

```

**D右になんか2文字**にマッチング

```bash

$./グレップレッスン.pl D..
D..
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x16673c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
DIS
ARRAY(0x1680620)
DIS

```

**D左になんか2文字**にマッチング

```bash

$./グレップレッスン.pl ..D
..D
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x1e113c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
SID
ARRAY(0x1e2a6c0)
SID

```

**I左右になんか1文字**にマッチング

```bash

$./グレップレッスン.pl .I.
.I.
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x21473c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
DISSID
ARRAY(0x21606b8)
DIS,SID

```

**yを含むもの**にマッチング

```bash

$./グレップレッスン.pl y
y
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x16783c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
r6yyy6y6r
ARRAY(0x1691768)
r6y,y,y6,y6r

```

**直後に6があるy**にマッチング

```bash

$./グレップレッスン.pl y\(?=6\)
y(?=6)
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0xa273c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
y6y6r
ARRAY(0xa40698)
y6,y6r

```

**直後に6がないy**にマッチング

```bash
$./グレップレッスン.pl y\(?\!6\)
y(?!6)
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x9863c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
r6yy
ARRAY(0x99f698)
r6y,y

```

**6を含むもの**にマッチング

```bash

$./グレップレッスン.pl 6
6
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x109e3c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
r6r6yy6y6r
ARRAY(0x10b7778)
r6,r6y,y6,y6r
```

**直前にrがない6**にマッチング

```bash
$./グレップレッスン.pl \(?\<=r\)6
(?<=r)6
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x1e1c3c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
r6r6y
ARRAY(0x1e356a8)
r6,r6y

```

**直前にrがない6**にマッチング

```bash
$./グレップレッスン.pl \(?\<\!r\)6
(?<!r)6
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x24a43c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
y6y6r
ARRAY(0x24bd6b8)
y6,y6r
```

**直前にrがあり6**にマッチング

```bash
$./グレップレッスン.pl \(?\<=r\)6
(?<=r)6
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x1cd33c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
r6r6y
ARRAY(0x1cec6a8)
r6,r6y
```

**直前にrがあり、直後にyがある6**にマッチング

```bash
$./グレップレッスン.pl \(?\<=r\)6\(?=y\)
(?<=r)6(?=y)
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x1ed23c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
r6y
ARRAY(0x1eeb6d0)
r6y
```

**直前にrがあり、直後にyがない6**にマッチング

```bash
$./グレップレッスン.pl \(?\<=r\)6\(?\!y\)
(?<=r)6(?!y)
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x18893c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
r6
ARRAY(0x18a26d0)
r6
```

**直前にrがない6**にマッチング

```bash
$./グレップレッスン.pl \(?\<\!r\)6
(?<!r)6
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0xf983c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
y6y6r
ARRAY(0xfb16b8)
y6,y6r
```

**直前にrがない、直後にrがある6**にマッチング

```bash
$./グレップレッスン.pl \(?\<\!r\)6\(?=r\)
(?<!r)6(?=r)
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x28be3c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
y6r
ARRAY(0x28d7630)
y6r
```

**直前にrがない、直後にrがない6**にマッチング

```bash
$./グレップレッスン.pl \(?\<\!r\)6\(?\!r\)
(?<!r)6(?!r)
--------------------------------------------------------------------------------
DDIDISSSISIDMMjMj999j9jMrr6r6yyy6y6r
ARRAY(0x142d3c0)
D,DI,DIS,S,SI,SID,M,Mj,Mj9,9,9j,9jM,r,r6,r6y,y,y6,y6r
================================================================================
y6
ARRAY(0x14466b0)
y6

```

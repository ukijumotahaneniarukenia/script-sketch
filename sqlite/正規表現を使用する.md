

```
$ls
Makefile  pcre.c  readme.txt  sqlite3-pcre.spec
$make
cc -shared -o pcre.so   -fPIC -W -Werror pcre.c -lpcre   -Wl,-z,defs
$ll
total 32
-rw-rw-r--. 1 sqlite sqlite   544 12月  1 17:23 Makefile
-rw-rw-r--. 1 sqlite sqlite  2580 12月  1 17:23 pcre.c
-rwxrwxr-x. 1 sqlite sqlite 12816 12月  1 17:28 pcre.so
-rw-rw-r--. 1 sqlite sqlite   225 12月  1 17:23 readme.txt
-rw-rw-r--. 1 sqlite sqlite  1147 12月  1 17:23 sqlite3-pcre.spec
$cat ~/.sqliterc
.mode column
.headers on
.width 0
.nullvalue "NULL"
.prompt "sqlite>>>"
.load ./series.so
.load ./extension-functions.so
.load ./sqlite3-pcre/pcre.so

```

https://shobon.hatenablog.com/entry/2018/02/14/204350
```
$sqlite
-- Loading resources from /home/sqlite/.sqliterc
SQLite version 3.30.0 2019-10-04 15:03:17
Enter ".help" for usage hints.
Connected to a transient in-memory database.
Use ".open FILENAME" to reopen on a persistent database.
sqlite>>>select * from test_tbl;
Error: no such table: test_tbl
sqlite>>>.read init.sql
Error: near line 1: no such table: test_tbl
sqlite>>>select * from test_tbl;
col1        col2        col3      
----------  ----------  ----------
aa          ab          ac        
ba          bb          bc        
ca          cb          cc        
ab          ac          ba        
bb          bc          ca        
cb          cc          aa        
ac          ba          bb        
bc          ca          cb        
cc          aa          ab        
ba          bb          bc        
ca          cb          cc        
aa          ab          ac        
bb          bc          ca        
cb          cc          aa        
ab          ac          ba        
bc          ca          cb        
cc          aa          ab        
ac          ba          bb        
ca          cb          cc        
aa          ab          ac        
ba          bb          bc        
cb          cc          aa        
ab          ac          ba        
bb          bc          ca        
cc          aa          ab        
ac          ba          bb        
bc          ca          cb        
sqlite>>>select * from test_tbl where col3 REGEXP 'a' ;
col1        col2        col3      
----------  ----------  ----------
aa          ab          ac        
ab          ac          ba        
bb          bc          ca        
cb          cc          aa        
cc          aa          ab        
aa          ab          ac        
bb          bc          ca        
cb          cc          aa        
ab          ac          ba        
cc          aa          ab        
aa          ab          ac        
cb          cc          aa        
ab          ac          ba        
bb          bc          ca        
cc          aa          ab        
sqlite>>>select * from test_tbl where col3 REGEXP '^a' ;
col1        col2        col3      
----------  ----------  ----------
aa          ab          ac        
cb          cc          aa        
cc          aa          ab        
aa          ab          ac        
cb          cc          aa        
cc          aa          ab        
aa          ab          ac        
cb          cc          aa        
cc          aa          ab        
sqlite>>>select * from test_tbl where col3 REGEXP 'a$' ;
col1        col2        col3      
----------  ----------  ----------
ab          ac          ba        
bb          bc          ca        
cb          cc          aa        
bb          bc          ca        
cb          cc          aa        
ab          ac          ba        
cb          cc          aa        
ab          ac          ba        
bb          bc          ca        
sqlite>>>select * from test_tbl where col3 REGEXP 'a(?=a)' ;
col1        col2        col3      
----------  ----------  ----------
cb          cc          aa        
cb          cc          aa        
cb          cc          aa        
sqlite>>>select * from test_tbl where col3 REGEXP '(?!=a)c';
col1        col2        col3      
----------  ----------  ----------
aa          ab          ac        
ba          bb          bc        
ca          cb          cc        
bb          bc          ca        
bc          ca          cb        
ba          bb          bc        
ca          cb          cc        
aa          ab          ac        
bb          bc          ca        
bc          ca          cb        
ca          cb          cc        
aa          ab          ac        
ba          bb          bc        
bb          bc          ca        
bc          ca          cb        
sqlite>>>select * from test_tbl where col3 REGEXP '(?<=a)c';
col1        col2        col3      
----------  ----------  ----------
aa          ab          ac        
aa          ab          ac        
aa          ab          ac        
sqlite>>>select * from test_tbl where col3 REGEXP '(?!<=a)c';
col1        col2        col3      
----------  ----------  ----------
aa          ab          ac        
ba          bb          bc        
ca          cb          cc        
bb          bc          ca        
bc          ca          cb        
ba          bb          bc        
ca          cb          cc        
aa          ab          ac        
bb          bc          ca        
bc          ca          cb        
ca          cb          cc        
aa          ab          ac        
ba          bb          bc        
bb          bc          ca        
bc          ca          cb        
sqlite>>>select * from test_tbl where col3 REGEXP '(?<=a)c';
col1        col2        col3      
----------  ----------  ----------
aa          ab          ac        
aa          ab          ac        
aa          ab          ac        
sqlite>>>select * from test_tbl where col3 REGEXP '(?<!a)c';
col1        col2        col3      
----------  ----------  ----------
ba          bb          bc        
ca          cb          cc        
bb          bc          ca        
bc          ca          cb        
ba          bb          bc        
ca          cb          cc        
bb          bc          ca        
bc          ca          cb        
ca          cb          cc        
ba          bb          bc        
bb          bc          ca        
bc          ca          cb        
sqlite>>>select * from test_tbl where col3 REGEXP 'c(?<=a)';
sqlite>>>select * from test_tbl where col3 REGEXP 'c(?=a)';
col1        col2        col3      
----------  ----------  ----------
bb          bc          ca        
bb          bc          ca        
bb          bc          ca        
sqlite>>>select * from test_tbl where col3 REGEXP '(?=a)';
col1        col2        col3      
----------  ----------  ----------
aa          ab          ac        
ab          ac          ba        
bb          bc          ca        
cb          cc          aa        
cc          aa          ab        
aa          ab          ac        
bb          bc          ca        
cb          cc          aa        
ab          ac          ba        
cc          aa          ab        
aa          ab          ac        
cb          cc          aa        
ab          ac          ba        
bb          bc          ca        
cc          aa          ab        
sqlite>>>select * from test_tbl where col3 REGEXP 'c(?=a)';
col1        col2        col3      
----------  ----------  ----------
bb          bc          ca        
bb          bc          ca        
bb          bc          ca        
sqlite>>>select * from test_tbl where col3 REGEXP 'c(?!a)';
col1        col2        col3      
----------  ----------  ----------
aa          ab          ac        
ba          bb          bc        
ca          cb          cc        
bc          ca          cb        
ba          bb          bc        
ca          cb          cc        
aa          ab          ac        
bc          ca          cb        
ca          cb          cc        
aa          ab          ac        
ba          bb          bc        
bc          ca          cb        
sqlite>>>select * from test_tbl where col3 REGEXP 'c(?!a)' and col2 regexp '.(?=a)';
col1        col2        col3      
----------  ----------  ----------
bc          ca          cb        
bc          ca          cb        
bc          ca          cb        
sqlite>>>select * from test_tbl where col3 REGEXP 'c(?!a)' and col2 regexp '*(?=a)';
Error: *(?=a): nothing to repeat (offset 0)
sqlite>>>select * from test_tbl where col3 REGEXP 'c(?!a)' and col2 regexp '.(?=a)';
col1        col2        col3      
----------  ----------  ----------
bc          ca          cb        
bc          ca          cb        
bc          ca          cb        
sqlite>>>select * from test_tbl where col3 REGEXP 'c(?!a)' and col2 regexp '..(?=a)';
sqlite>>>select * from test_tbl where col3 REGEXP 'c(?!a)' or col2 regexp '.(?=a)';
col1        col2        col3      
----------  ----------  ----------
aa          ab          ac        
ba          bb          bc        
ca          cb          cc        
ac          ba          bb        
bc          ca          cb        
cc          aa          ab        
ba          bb          bc        
ca          cb          cc        
aa          ab          ac        
bc          ca          cb        
cc          aa          ab        
ac          ba          bb        
ca          cb          cc        
aa          ab          ac        
ba          bb          bc        
cc          aa          ab        
ac          ba          bb        
bc          ca          cb        

```

こっちだと肯定先読みとかできない

```
$curl -LO https://www.sqlite.org/src/raw/ext/misc/regexp.c?name=653b6ab5e89bcb5d45f9ebe0747d7f8f3f5706cac963fcbc9a3ddbe5fdc1efa2
$mv regexp.c?name=653b6ab5e89bcb5d45f9ebe0747d7f8f3f5706cac963fcbc9a3ddbe5fdc1efa2 regexp.c
$sudo gcc -fPIC -shared -I /usr/local/src/sqlite-autoconf-3300000/ -o regexp.so regexp.c

```


```
sqlite>>>select * from test_tbl where col3 REGEXP 'c(?!a)' or col2 regexp '.(?=a)';
Error: '?' without operand

```


# create table文作成
```
$colztxt 3 | ahead "create table test_tbl(" | atail ");"
create table test_tbl(col1 text,col2 text,col3 text);
```

# insert文作成
```
$echo {a..c}{a..c} | xargs -n3 |  ahead "\x22" | atail "\x22" | sed 's; ;\x22,\x22;g' | ahead "insert into test_tbl values(" | atail ");"
insert into test_tbl values("aa","ab","ac");
insert into test_tbl values("ba","bb","bc");
insert into test_tbl values("ca","cb","cc");
```

# drop table文作成
```
$echo "drop table test_tbl;" >init.sql
drop table test_tbl;
```

# init.sqlに追記
```
$echo "drop table test_tbl;" >init.sql
$colztxt 3 | ahead "create table test_tbl(" | atail ");" >>init.sql
$echo {a..c}{a..c} | circle | xargs -n3 |  ahead "\x22" | atail "\x22" | sed 's; ;\x22,\x22;g' | ahead "insert into test_tbl values(" | atail ";" >>init.sql
```

# 初期投入データ確認
```
$cat init.sql
drop table test_tbl;
create table test_tbl(col1 text,col2 text,col3 text);
insert into test_tbl values("aa","ab","ac");
insert into test_tbl values("ba","bb","bc");
insert into test_tbl values("ca","cb","cc");
insert into test_tbl values("ab","ac","ba");
insert into test_tbl values("bb","bc","ca");
insert into test_tbl values("cb","cc","aa");
insert into test_tbl values("ac","ba","bb");
insert into test_tbl values("bc","ca","cb");
insert into test_tbl values("cc","aa","ab");
insert into test_tbl values("ba","bb","bc");
insert into test_tbl values("ca","cb","cc");
insert into test_tbl values("aa","ab","ac");
insert into test_tbl values("bb","bc","ca");
insert into test_tbl values("cb","cc","aa");
insert into test_tbl values("ab","ac","ba");
insert into test_tbl values("bc","ca","cb");
insert into test_tbl values("cc","aa","ab");
insert into test_tbl values("ac","ba","bb");
insert into test_tbl values("ca","cb","cc");
insert into test_tbl values("aa","ab","ac");
insert into test_tbl values("ba","bb","bc");
insert into test_tbl values("cb","cc","aa");
insert into test_tbl values("ab","ac","ba");
insert into test_tbl values("bb","bc","ca");
insert into test_tbl values("cc","aa","ab");
insert into test_tbl values("ac","ba","bb");
insert into test_tbl values("bc","ca","cb");
```

# データベースファイル削除
```
$rm testdb
```


# 初期データ投入スクリプトでtestdbデータベースにデータ投入
```
$sqlite testdb '.read init.sql'
-- Loading resources from /home/sqlite/.sqliterc
```

# sqliteシェルに潜入
```
$sqlite testdb
-- Loading resources from /home/sqlite/.sqliterc
SQLite version 3.30.0 2019-10-04 15:03:17
Enter ".help" for usage hints.
sqlite>>>select * from test_tbl;
col1        col2        col3      
----------  ----------  ----------
aa          ab          ac        
ba          bb          bc        
ca          cb          cc        
ab          ac          ba        
bb          bc          ca        
cb          cc          aa        
ac          ba          bb        
bc          ca          cb        
cc          aa          ab        
ba          bb          bc        
ca          cb          cc        
aa          ab          ac        
bb          bc          ca        
cb          cc          aa        
ab          ac          ba        
bc          ca          cb        
cc          aa          ab        
ac          ba          bb        
ca          cb          cc        
aa          ab          ac        
ba          bb          bc        
cb          cc          aa        
ab          ac          ba        
bb          bc          ca        
cc          aa          ab        
ac          ba          bb        
bc          ca          cb        
```


# 調査クエリでデータ取得

取得結果をoutファイルにリダイレクトできる


```
$cat a.sql
select col1,group_concat(col2,",") from test_tbl group by col1;
select col1,group_concat(distinct col2) from test_tbl group by col1;
select col1,col2,group_concat(col3) from test_tbl group by col1,col2;
select col1,col2,count(col3),count(distinct col3),group_concat(col3),group_concat(distinct col3) from test_tbl group by col1,col2;
select col1,col2,total(col3) from test_tbl group by col1,col2;
```


```
$sqlite testdb ".read init.sql"
-- Loading resources from /home/sqlite/.sqliterc
Error: near line 1: no such table: test_tbl
$sqlite testdb ".read a.sql"
-- Loading resources from /home/sqlite/.sqliterc
col1        group_concat(col2,",")
----------  ----------------------
aa          ab,ab,ab              
ab          ac,ac,ac              
ac          ba,ba,ba              
ba          bb,bb,bb              
bb          bc,bc,bc              
bc          ca,ca,ca              
ca          cb,cb,cb              
cb          cc,cc,cc              
cc          aa,aa,aa              
col1        group_concat(distinct col2)
----------  ---------------------------
aa          ab                         
ab          ac                         
ac          ba                         
ba          bb                         
bb          bc                         
bc          ca                         
ca          cb                         
cb          cc                         
cc          aa                         
col1        col2        group_concat(col3)
----------  ----------  ------------------
aa          ab          ac,ac,ac          
ab          ac          ba,ba,ba          
ac          ba          bb,bb,bb          
ba          bb          bc,bc,bc          
bb          bc          ca,ca,ca          
bc          ca          cb,cb,cb          
ca          cb          cc,cc,cc          
cb          cc          aa,aa,aa          
cc          aa          ab,ab,ab          
col1        col2        count(col3)  count(distinct col3)  group_concat(col3)  group_concat(distinct col3)
----------  ----------  -----------  --------------------  ------------------  ---------------------------
aa          ab          3            1                     ac,ac,ac            ac                         
ab          ac          3            1                     ba,ba,ba            ba                         
ac          ba          3            1                     bb,bb,bb            bb                         
ba          bb          3            1                     bc,bc,bc            bc                         
bb          bc          3            1                     ca,ca,ca            ca                         
bc          ca          3            1                     cb,cb,cb            cb                         
ca          cb          3            1                     cc,cc,cc            cc                         
cb          cc          3            1                     aa,aa,aa            aa                         
cc          aa          3            1                     ab,ab,ab            ab                         
col1        col2        total(col3)
----------  ----------  -----------
aa          ab          0.0        
ab          ac          0.0        
ac          ba          0.0        
ba          bb          0.0        
bb          bc          0.0        
bc          ca          0.0        
ca          cb          0.0        
cb          cc          0.0        
cc          aa          0.0        
$sqlite testdb ".read a.sql" >out
-- Loading resources from /home/sqlite/.sqliterc
```

```
$cat out
col1        group_concat(col2,",")
----------  ----------------------
aa          ab,ab,ab              
ab          ac,ac,ac              
ac          ba,ba,ba              
ba          bb,bb,bb              
bb          bc,bc,bc              
bc          ca,ca,ca              
ca          cb,cb,cb              
cb          cc,cc,cc              
cc          aa,aa,aa              
col1        group_concat(distinct col2)
----------  ---------------------------
aa          ab                         
ab          ac                         
ac          ba                         
ba          bb                         
bb          bc                         
bc          ca                         
ca          cb                         
cb          cc                         
cc          aa                         
col1        col2        group_concat(col3)
----------  ----------  ------------------
aa          ab          ac,ac,ac          
ab          ac          ba,ba,ba          
ac          ba          bb,bb,bb          
ba          bb          bc,bc,bc          
bb          bc          ca,ca,ca          
bc          ca          cb,cb,cb          
ca          cb          cc,cc,cc          
cb          cc          aa,aa,aa          
cc          aa          ab,ab,ab          
col1        col2        count(col3)  count(distinct col3)  group_concat(col3)  group_concat(distinct col3)
----------  ----------  -----------  --------------------  ------------------  ---------------------------
aa          ab          3            1                     ac,ac,ac            ac                         
ab          ac          3            1                     ba,ba,ba            ba                         
ac          ba          3            1                     bb,bb,bb            bb                         
ba          bb          3            1                     bc,bc,bc            bc                         
bb          bc          3            1                     ca,ca,ca            ca                         
bc          ca          3            1                     cb,cb,cb            cb                         
ca          cb          3            1                     cc,cc,cc            cc                         
cb          cc          3            1                     aa,aa,aa            aa                         
cc          aa          3            1                     ab,ab,ab            ab                         
col1        col2        total(col3)
----------  ----------  -----------
aa          ab          0.0        
ab          ac          0.0        
ac          ba          0.0        
ba          bb          0.0        
bb          bc          0.0        
bc          ca          0.0        
ca          cb          0.0        
cb          cc          0.0        
cc          aa          0.0        
```

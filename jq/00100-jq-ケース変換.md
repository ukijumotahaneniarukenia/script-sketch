IN

```
$ cat a.json
{
  "unko": "うんこ",
  "unko_mori": "うんこもり",
  "unko_mori_mori": "うんこもりもり"
}
```


CMD

```
$ cat a.json | jq '. as $in|keys|map(split("_") as $j|($j[:1][])+($j[1:]|map(split("") as $k|(($k[:1][]|ascii_upcase),($k[1:]|join(""))))|join(""))) as $newKeyList|($in|to_entries) as $itemList|[range(0;$itemList|length)]|map({"key":($newKeyList[.]),"value":$itemList[.].value})|from_entries'
```

OUT


```
{
  "unko": "うんこ",
  "unkoMori": "うんこもり",
  "unkoMoriMori": "うんこもりもり"
}
```


これがむずい

walk to_entries walk map walk from_entriesの一連

IN

```
$ cat b.json
{
  "cast": {
    "person": [
      {
        "role": "Mark Watney",
        "name": "Matt Damon"
      },
      {
        "role": "Melissa Lewis",
        "name": "Jessica Chastain"
      },
      {
        "role": "Annie Montrose",
        "name": "Kristen Wiig"
      }
    ]
  },
  "director": "Ridley Scott",
  "release-date": "2015-10-02",
  "mpaa-rating": "PG-13",
  "running-time": 144
}
```

CMD
```
$ cat b.json |jq 'def a(e;sep): e|split(sep) as $j|($j[:1][])+($j[1:]|map(split("") as $k|(($k[:1][]|ascii_upcase),($k[1:]|join(""))))|join(""));walk(if type == "object" then to_entries else . end)|walk(if type=="object" and has("key") then .key |= a(.;"-") else . end)'
[
  {
    "key": "cast",
    "value": [
      {
        "key": "person",
        "value": [
          [
            {
              "key": "role",
              "value": "Mark Watney"
            },
            {
              "key": "name",
              "value": "Matt Damon"
            }
          ],
          [
            {
              "key": "role",
              "value": "Melissa Lewis"
            },
            {
              "key": "name",
              "value": "Jessica Chastain"
            }
          ],
          [
            {
              "key": "role",
              "value": "Annie Montrose"
            },
            {
              "key": "name",
              "value": "Kristen Wiig"
            }
          ]
        ]
      }
    ]
  },
  {
    "key": "director",
    "value": "Ridley Scott"
  },
  {
    "key": "releaseDate",
    "value": "2015-10-02"
  },
  {
    "key": "mpaaRating",
    "value": "PG-13"
  },
  {
    "key": "runningTime",
    "value": 144
  }
]
```


これがだめなのがよくわからん

```
$ cat b.json |jq 'def a(e;sep): e|split(sep) as $j|($j[:1][])+($j[1:]|map(split("") as $k|(($k[:1][]|ascii_upcase),($k[1:]|join(""))))|join(""));walk(if type == "object" then to_entries else . end)|walk(if type=="object" and has("key") then .key |= a(.;"-") else . end)|walk(if (type == "object") then [.]|from_entries elif (type=="array") then from_entries else . end)'
jq: error (at <stdin>:22): Cannot use null (null) as object key
```

配列もいけると思ったが。。。

```
$ cat b.json |jq 'def a(e;sep): e|split(sep) as $j|($j[:1][])+($j[1:]|map(split("") as $k|(($k[:1][]|ascii_upcase),($k[1:]|join(""))))|join(""));walk(if type == "object" then to_entries else . end)|walk(if type=="object" and has("key") then .key |= a(.;"-") else . end)|walk(if (type == "object") then [.]|from_entries elif (type=="array") then . else . end)'
[
  {
    "cast": [
      {
        "person": [
          [
            {
              "roleName": "Mark Watney"
            },
            {
              "canonicalName": "Matt Damon"
            }
          ],
          [
            {
              "roleName": "Melissa Lewis"
            },
            {
              "canonicalName": "Jessica Chastain"
            }
          ],
          [
            {
              "roleName": "Annie Montrose"
            },
            {
              "canonicalName": "Kristen Wiig"
            }
          ]
        ]
      }
    ]
  },
  {
    "director": "Ridley Scott"
  },
  {
    "releaseDate": "2015-10-02"
  },
  {
    "mpaaRating": "PG-13"
  },
  {
    "runningTime": 144
  }
]
```
